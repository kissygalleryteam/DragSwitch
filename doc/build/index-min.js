/*!build time : 2014-04-03 6:09:50 PM*/
(function(){KISSY.add("kg/DragSwitch/2.0.0/main",function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return e=KISSY.all,g=Math.abs,d.webkit?(h="-webkit-",n="webkit"):d.firefox?(h="-moz-",n="moz"):d.ie?(h="-ms-",n="ms"):h=n="",j={senDistance:1,angle:Math.PI/4,checkEnabled:null,disable:!1,binds:[null,null,null,null,{moveSelf:!0,moveEls:[],maxDistance:99999,validDistance:null,checkEnabled:null,friction:!1,transition:!0}]},l=function(a){return a.css(""+h+"transform")},s=function(a,b){return a[0].style[""+n+"Transform"]=b},r=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.matrixState=l(b));return e},p=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(s(b,b.matrixState));return e},i=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b[0].style[""+n+"Transform"]="");return e},m=function(a){return a[0].style[""+n+"Transition"]},t=function(a,b){return a[0].style[""+n+"Transition"]=b},k=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],b.transitionState=m(b),e.push(t(b,"none"));return e},q=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(t(b,b.transitionState));return e},u=function(a,b,c){var d;return d=o(a),d[4]+=b*c,d[5]+=b*(1-c),"matrix("+d.join(",")+")"},o=function(a){var b;return a||(a="matrix(2.0.0,0,2.0.0,0)"),b=a.match(/[0-9\.\-]+/g),b||(b=[2.0.0,0,2.0.0,0]),b.forEach(function(a,c){return b[c]=parseFloat(a)}),b},f=function(){function b(b,c){this.el=b,this.config=c,a.mix(this,a.Event.Target),this.init()}return b.prototype.init=function(){var b,c,d,f,g,h,i,k,l;for(this.config=a.merge(j,this.config),this.disable=this.config.disable,"string"==typeof this.el&&(this.isSelector=!0),this.isSelector||(this.el=e(this.el)),this.realEl=e(this.el),this.tanAngel=Math.tan(this.config.angle),k=this.config.binds,f=0,h=k.length;h>f;f++)if(b=k[f],b&&b.validDistance)for(null==b.transition&&(b.transition=!0),null==b.moveSelf&&(b.moveSelf=!0),null==b.moveEls&&(b.moveEls=[]),l=b.moveEls,c=g=0,i=l.length;i>g;c=++g)d=l[c],b.moveEls[c]=e(d);return this.bindEvents()},b.prototype.bindEvents=function(){var a=this;return this.isSelector?(e("body").delegate("touchstart pointerdown mousedown",this.el,function(b){return a.touchStart(b)}),e("body").delegate("touchmove pointermove mousemove",this.el,function(b){return a.touchMove(b)}),e("body").delegate("touchend pointerup mouseup",this.el,function(b){return a.touchEnd(b)})):(this.el.on("touchstart pointerdown mousedown",function(b){return a.touchStart(b)}),this.el.on("touchmove pointermove mousemove",function(b){return a.touchMove(b)}),this.el.on("touchend pointerup mouseup",function(b){return a.touchEnd(b)}))},b.prototype.touchStart=function(a){var b,c;if(!this.disable&&(this.fire("touchStart",a),this.enabled=this.config.checkEnabled?this.config.checkEnabled():!0,this.enabled))return b=a.originalEvent||a,this.istouchStart=!0,this.isSendStart=!1,this.eventType=null,this.key=null,this.actuMoveEls=[],this.startPoint=[b.pageX||b.touches[0].pageX,b.pageY||b.touches[0].pageY],this.originalEl=this.isSelector&&(c=e(b.target).parent(this.el))?c:e(b.currentTarget)},b.prototype.touchMove=function(a){var b,c,d,e,f,h=this;if(this.istouchStart&&(!this.isSendStart||this.effectBind)){if(d=a.originalEvent||a,f=[d.pageX||d.touches[0].pageX,d.pageY||d.touches[0].pageY],e=this.startPoint,b=g((e[1]-f[1])/(f[0]-e[0])),c=[f[0]-e[0],f[1]-e[1]],!this.isSendStart&&b>this.tanAngel&&1/b>this.tanAngel)return void(this.istouchStart=!1);if(!this.eventType){if(b<=this.tanAngel&&g(c[0])>this.config.senDistance)this.eventType=c[0]>0?"left":"right";else{if(!(1/b<=this.tanAngel&&g(c[1])>this.config.senDistance))return;this.eventType=c[1]>0?"top":"bottom"}if(this.key="top"===this.eventType?0:"right"===this.eventType?1:"bottom"===this.eventType?2:"left"===this.eventType?3:null,this.isVertical=1-this.key%2,this.effectBind=this.config.binds[this.key],!this.effectBind)return;this.effectBind.passed=!1,this.moveEls=this.effectBind.moveEls,this.actuMoveEls=this.moveEls.slice(),this.effectBind.moveSelf&&this.actuMoveEls.push(this.originalEl),r(this.actuMoveEls),this.enabled=function(){return h.effectBind.checkEnabled?h.effectBind.checkEnabled.call(h,a):!0}(),k(this.actuMoveEls)}if(this.eventType&&this.enabled&&this.effectBind)return a.stopPropagation(),this.isSendStart||(this.isSendStart=!0,this.fire(this.eventType+"BeforeMove",a)),this.fire(this.eventType+"Move",a),a.isDefaultPrevented()?void 0:(a.halt(),this.move(f))}},b.prototype.touchEnd=function(a){return this.istouchStart=!1,this.eventType&&this.enabled&&this.effectBind&&this.isSendStart?(this.isSendStart=!1,this.touchEndHandler(a)):void 0},b.prototype.touchEndHandler=function(a){return q(this.actuMoveEls),this.effectBind.transition&&this.transitionEndHandler(a),g(this.distance)>=g(this.effectBind.validDistance)?(this.effectBind.passed=!0,i(this.actuMoveEls),this.fire(""+this.eventType+"Passed",a)):(p(this.actuMoveEls),this.fire(""+this.eventType+"Failed",a)),this.fire(this.eventType+"TouchEnd touchEnd",a)},b.prototype.transitionEndHandler=function(a){var b,c,d,e,f=this;return d=g(this._startPoint-this._lastPoint)/(this.startTimeS-this.lastTimeS),d=Math.sqrt(d),d=4>d?4:d,c=g(this.effectBind.maxDistance-this.distance),b=c/d+"ms",this.actuMoveEls.forEach(function(a){return t(a,""+h+"transform "+b+" ease")}),e=function(){return f.fire(""+f.eventType+"MoveEnd",a),q(f.actuMoveEls),f.actuMoveEls[0].detach(""+n+"TransitionEnd",e)},this.actuMoveEls[0].on(""+n+"TransitionEnd",e)},b.prototype.move=function(a){var b,c,d,e,f,h,i,j,k;for(this.endPoint=a,this.effectBind.transition&&(this.lastTimeS=this.startTimeS?this.startTimeS:null,this.startTimeS=new Date,this._lastPoint=this._startPoint?this._startPoint:null,this._startPoint=this.isVertical?this.endPoint[1]:this.endPoint[0]),f=this.isVertical?this.endPoint[1]-this.startPoint[1]:this.endPoint[0]-this.startPoint[0],d=0===this.key||3===this.key,this.distance=d?f-this.config.senDistance:f+this.config.senDistance,this.effectBind.friction&&this.effectBind.maxDistance&&g(this.distance)>g(this.effectBind.maxDistance)&&(b=Math.sqrt(5*g(e-this.effectBind.maxDistance)),d||(b=-b),this.distance=e=this.effectBind.maxDistance+b),j=this.actuMoveEls,k=[],h=0,i=j.length;i>h;h++)c=j[h],k.push(s(c,u(c.matrixState,this.distance,!this.isVertical)));return k},b}()},{requires:["node","event","ua"]})}).call(this),KISSY.add("kg/DragSwitch/2.0.0/index",function(a,b){return b},{requires:["./main"]});